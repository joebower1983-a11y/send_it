# Send.it Cross-Chain Bridge Design

## Overview

Send.it Bridge enables tokens launched on Solana via the Send.it platform to be bridged to **Ethereum**, **Base**, and **BSC** using [Wormhole](https://wormhole.com/) as the cross-chain messaging layer. This document covers the mechanism, fees, security model, and user flow.

---

## Supported Chains

| Chain    | Chain ID (Wormhole) | Status  | Bridge Fee |
|----------|---------------------|---------|------------|
| Solana   | 1                   | Origin  | —          |
| Ethereum | 2                   | Target  | 0.5%       |
| BSC      | 4                   | Target  | 0.3%       |
| Base     | 30                  | Target  | 0.3%       |

---

## Lock-and-Mint Mechanism

Tokens are **not burned** on Solana. They are locked in a program-owned vault, and a wrapped representation is minted on the destination chain via Wormhole's token bridge contracts.

### How It Works

1. User calls `initiate_bridge` on Solana — tokens transferred to vault PDA
2. Solana program emits a Wormhole message with transfer details
3. Wormhole Guardians observe and sign a VAA (Verified Action Approval)
4. User (or relayer) submits the VAA on the destination chain
5. Wormhole token bridge mints wrapped tokens to the destination address
6. On Solana, `confirm_bridge` finalizes the request after VAA verification

### Redemption (Destination → Solana)

1. User burns wrapped tokens on destination chain via Wormhole
2. VAA generated by Guardians
3. VAA submitted on Solana to unlock tokens from vault

---

## Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                        USER FLOW                                │
└─────────────────────────────────────────────────────────────────┘

  User Wallet (Solana)                    User Wallet (EVM)
       │                                       ▲
       │ 1. initiate_bridge                    │ 5. claim wrapped tokens
       ▼                                       │
┌──────────────┐                        ┌──────────────┐
│  Send.it     │   2. Wormhole Msg      │  Wormhole    │
│  Bridge      │ ─────────────────────► │  Token Bridge│
│  Program     │                        │  (EVM)       │
│              │                        │              │
│  ┌────────┐  │   3. Guardian Signs    │  ┌────────┐  │
│  │ Token  │  │      VAA              │  │Wrapped │  │
│  │ Vault  │  │ ◄───────────────────  │  │Token   │  │
│  │ (PDA)  │  │                        │  │Mint    │  │
│  └────────┘  │   4. VAA relayed       │  └────────┘  │
│              │ ─────────────────────► │              │
└──────────────┘                        └──────────────┘
       │
       │ 6. confirm_bridge (VAA verified)
       ▼
  BridgeRequest status = Completed
```

```
┌─────────────────────────────────────────────────────────┐
│                   ACCOUNT STRUCTURE                      │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  BridgeConfig (PDA)                                     │
│  seeds: ["bridge_config"]                               │
│  ┌───────────────────────────────────┐                  │
│  │ authority: Pubkey                 │                  │
│  │ wormhole_program: Pubkey          │                  │
│  │ supported_chains: Vec<ChainInfo>  │                  │
│  │ total_bridged: u64                │                  │
│  │ paused: bool                      │                  │
│  └───────────────────────────────────┘                  │
│                                                         │
│  BridgeRequest (PDA)                                    │
│  seeds: ["bridge_req", user, nonce]                     │
│  ┌───────────────────────────────────┐                  │
│  │ user: Pubkey                      │                  │
│  │ token_mint: Pubkey                │                  │
│  │ amount: u64                       │                  │
│  │ fee_amount: u64                   │                  │
│  │ destination_chain: u16            │                  │
│  │ destination_address: [u8; 32]     │                  │
│  │ status: BridgeStatus              │                  │
│  │ created_at: i64                   │                  │
│  │ wormhole_sequence: Option<u64>    │                  │
│  └───────────────────────────────────┘                  │
│                                                         │
│  TokenVault (PDA, token account)                        │
│  seeds: ["vault", token_mint]                           │
│  ┌───────────────────────────────────┐                  │
│  │ Standard SPL Token Account        │                  │
│  │ Owner: BridgeConfig PDA           │                  │
│  └───────────────────────────────────┘                  │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## Bridge Fees

- Fees are taken in the bridged token before locking
- Fee goes to a protocol-owned fee vault
- Fee percentages are configurable per chain in `BridgeConfig`
- Minimum bridge amount enforced to prevent dust attacks

| Parameter        | Value     |
|------------------|-----------|
| Ethereum fee     | 0.5%      |
| Base fee         | 0.3%      |
| BSC fee          | 0.3%      |
| Min bridge       | 1,000 tokens |
| Expiry timeout   | 24 hours  |

---

## Security Model

### On-Chain Security
- **PDA-owned vaults**: Tokens locked in program-derived token accounts — no admin key can drain
- **Authority checks**: Only config authority can update chain settings or pause bridge
- **Pause mechanism**: Global pause flag halts all bridge operations in emergencies
- **Expiry & cancellation**: Requests expire after 24h; users can cancel and reclaim tokens

### Wormhole Security
- **Guardian network**: 19 Guardians, 13/19 threshold for VAA signing
- **VAA verification**: On-chain verification of Guardian signatures before confirming bridge
- **Sequence tracking**: Each bridge request maps to a Wormhole sequence number to prevent replay

### Additional Measures
- Rate limiting per user (max bridges per epoch)
- Token allowlist (only Send.it-launched tokens can bridge)
- Destination address validation per chain format

---

## User Flow

```
┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐
│  Select  │    │  Enter   │    │  Confirm │    │  Wait    │    │  Claim   │
│  Token   │───►│  Amount  │───►│  Bridge  │───►│  VAA     │───►│  on EVM  │
│  & Chain │    │  & Addr  │    │  Tx      │    │  (~2min) │    │          │
└──────────┘    └──────────┘    └──────────┘    └──────────┘    └──────────┘
```

1. **Select token & destination chain** — User picks a Send.it token and target (ETH/Base/BSC)
2. **Enter amount & destination address** — Amount to bridge, EVM address to receive
3. **Confirm bridge transaction** — Signs Solana tx calling `initiate_bridge`
4. **Wait for Wormhole VAA** — ~2 minutes for Guardian consensus
5. **Claim on destination** — Submit VAA to Wormhole Token Bridge on EVM chain (auto-relayer or manual)

---

## Future Considerations

- **Auto-relayer**: Integrate Wormhole automatic relaying so users don't need to manually claim
- **Bridge back (redeem)**: UI flow for burning wrapped tokens and unlocking on Solana
- **Multi-hop**: Bridge between EVM chains via Solana as hub
- **Fee distribution**: Route portion of bridge fees to token creators
- **Governance**: DAO control over bridge parameters
