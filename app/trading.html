<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Send.it ‚Äî AMM Trading</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script src="https://unpkg.com/@solana/web3.js@1.95.3/lib/index.iife.min.js"></script>
<script src="https://unpkg.com/@solana/spl-token@0.3.11/lib/cjs/index.js" type="module"></script>
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
--bg:#0a0e17;--bg2:#1a1f2e;--bg3:#242a3d;--bg4:#2e3650;
--accent:#00c896;--accent2:#00e6a8;--pink:#ff2d78;--purple:#a855f7;--orange:#ff8800;
--text:#e8e8f0;--text2:#8888aa;--text3:#555570;
--glow:0 0 20px rgba(0,200,150,.3);
--radius:12px;--radius2:8px;
}
html{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);scroll-behavior:smooth}
body{min-height:100vh;overflow-x:hidden;background-image:linear-gradient(rgba(0,200,150,.02) 1px,transparent 1px),linear-gradient(90deg,rgba(0,200,150,.02) 1px,transparent 1px);background-size:60px 60px}
a{color:inherit;text-decoration:none}
button{cursor:pointer;font-family:inherit;border:none;outline:none}
input,select{font-family:inherit;outline:none;border:none;background:var(--bg);color:var(--text);border-radius:var(--radius2);padding:12px 16px;font-size:14px;width:100%;transition:.2s}
input:focus,select:focus{box-shadow:0 0 0 2px var(--accent),var(--glow)}
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:var(--bg)}::-webkit-scrollbar-thumb{background:var(--bg4);border-radius:3px}

header{position:sticky;top:0;z-index:100;background:rgba(10,14,23,.95);backdrop-filter:blur(20px);border-bottom:1px solid rgba(0,200,150,.15);padding:0 24px;height:64px;display:flex;align-items:center;justify-content:space-between}
.logo{display:flex;align-items:center;gap:10px;font-weight:900;font-size:22px;letter-spacing:-1px}
.logo span{color:var(--accent);text-shadow:0 0 20px rgba(0,200,150,.4)}
.wallet-btn{padding:10px 20px;border-radius:10px;font-weight:700;font-size:13px;color:#000;background:linear-gradient(135deg,var(--accent),var(--accent2));transition:.3s}
.wallet-btn:hover{transform:translateY(-1px);box-shadow:var(--glow)}

nav{position:sticky;top:64px;z-index:99;background:rgba(10,14,23,.95);backdrop-filter:blur(12px);border-bottom:1px solid rgba(0,200,150,.08);display:flex;justify-content:center;gap:4px;padding:8px 16px;flex-wrap:wrap}
.nav-item{padding:10px 18px;border-radius:10px;font-size:13px;font-weight:600;color:var(--text2);transition:.25s;display:flex;align-items:center;gap:6px}
.nav-item:hover{color:var(--text);background:var(--bg2)}
.nav-item.active{color:var(--accent);background:rgba(0,200,150,.08)}

main{flex:1;padding:24px;max-width:1400px;margin:0 auto;width:100%}
.card{background:var(--bg2);border:1px solid rgba(255,255,255,.05);border-radius:var(--radius);padding:20px;transition:.25s}
.card:hover{border-color:rgba(0,200,150,.15)}
.section-title{font-size:20px;font-weight:800;margin-bottom:16px;display:flex;align-items:center;gap:8px}
.section-title i{color:var(--accent)}
.mono{font-family:'JetBrains Mono',monospace}
.green{color:#22c55e}.red{color:#ef4444}
.badge{display:inline-block;padding:2px 8px;border-radius:10px;font-size:11px;font-weight:700}
.badge-green{background:rgba(34,197,94,.12);color:#22c55e}
.badge-accent{background:rgba(0,200,150,.12);color:var(--accent)}
.badge-purple{background:rgba(168,85,247,.12);color:#a855f7}
.badge-orange{background:rgba(255,136,0,.12);color:#ff8800}

/* Layout */
.trading-layout{display:grid;grid-template-columns:320px 1fr 320px;gap:16px;margin-bottom:24px}
@media(max-width:1100px){.trading-layout{grid-template-columns:1fr;}}

/* Pool selector */
.pool-list{max-height:400px;overflow-y:auto}
.pool-item{display:flex;align-items:center;gap:12px;padding:12px;border-radius:var(--radius2);cursor:pointer;transition:.2s;border:1px solid transparent}
.pool-item:hover{background:var(--bg3)}
.pool-item.active{border-color:var(--accent);background:rgba(0,200,150,.05)}
.pool-icon{width:40px;height:40px;border-radius:10px;background:var(--bg4);display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0}
.pool-name{font-weight:700;font-size:14px}
.pool-pair{color:var(--accent);font-size:12px;font-family:'JetBrains Mono',monospace}
.pool-tvl{color:var(--text2);font-size:12px}

/* Swap card */
.swap-card{max-width:480px;margin:0 auto}
.swap-box{background:var(--bg);border-radius:var(--radius);padding:16px;margin-bottom:4px;position:relative}
.swap-box label{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text3);margin-bottom:8px;display:block}
.swap-input-row{display:flex;align-items:center;gap:12px}
.swap-input-row input{font-size:24px;font-weight:700;font-family:'JetBrains Mono',monospace;background:transparent;padding:0;flex:1}
.swap-input-row input::placeholder{color:var(--text3)}
.token-badge{display:flex;align-items:center;gap:6px;background:var(--bg3);padding:6px 12px;border-radius:20px;font-weight:700;font-size:13px;flex-shrink:0}
.token-badge img,.token-badge .icon{width:20px;height:20px;border-radius:50%}
.swap-balance{font-size:12px;color:var(--text3);margin-top:8px;display:flex;justify-content:space-between}
.swap-balance span{color:var(--accent);cursor:pointer;font-weight:600}
.swap-arrow{display:flex;justify-content:center;margin:-8px 0;position:relative;z-index:2}
.swap-arrow button{width:36px;height:36px;border-radius:10px;background:var(--bg3);border:3px solid var(--bg2);color:var(--accent);font-size:16px;display:flex;align-items:center;justify-content:center;transition:.2s}
.swap-arrow button:hover{transform:rotate(180deg);background:var(--accent);color:#000}

.swap-details{background:var(--bg);border-radius:var(--radius2);padding:12px 16px;margin-top:12px}
.swap-detail-row{display:flex;justify-content:space-between;font-size:13px;padding:4px 0}
.swap-detail-row .label{color:var(--text2)}
.swap-detail-row .value{font-weight:600;font-family:'JetBrains Mono',monospace}

.btn-swap{width:100%;padding:18px;border-radius:var(--radius);font-size:18px;font-weight:900;color:#000;background:linear-gradient(135deg,var(--accent),#00e07a);transition:.3s;text-transform:uppercase;letter-spacing:2px;margin-top:16px}
.btn-swap:hover{transform:translateY(-2px);box-shadow:0 8px 40px rgba(0,200,150,.4)}
.btn-swap:disabled{opacity:.5;cursor:not-allowed;transform:none;box-shadow:none}

/* Tabs */
.tabs{display:flex;gap:4px;margin-bottom:16px;background:var(--bg);border-radius:var(--radius2);padding:4px}
.tab{flex:1;padding:10px;text-align:center;border-radius:6px;font-weight:700;font-size:13px;color:var(--text2);cursor:pointer;transition:.2s}
.tab.active{background:var(--accent);color:#000}
.tab:hover:not(.active){color:var(--text)}

/* LP Section */
.lp-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:16px}
@media(max-width:768px){.lp-stats{grid-template-columns:1fr 1fr}}
.lp-stat{background:var(--bg);border-radius:var(--radius2);padding:14px;text-align:center}
.lp-stat .num{font-size:20px;font-weight:900;font-family:'JetBrains Mono',monospace;color:var(--accent)}
.lp-stat .lbl{font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-top:4px}

.lp-form{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px}
@media(max-width:640px){.lp-form{grid-template-columns:1fr}}
.lp-input-group{background:var(--bg);border-radius:var(--radius2);padding:14px}
.lp-input-group label{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text3);margin-bottom:6px;display:block}
.lp-input-group input{font-size:18px;font-weight:700;font-family:'JetBrains Mono',monospace;background:transparent;padding:0}

/* Pool chart */
.pool-chart{height:200px;background:var(--bg);border-radius:var(--radius);padding:12px;margin-bottom:16px;position:relative}
.pool-chart canvas{width:100%!important;height:100%!important}

/* Positions table */
.positions-table{width:100%;border-collapse:collapse}
.positions-table th{font-size:11px;text-transform:uppercase;letter-spacing:1px;color:var(--text3);text-align:left;padding:10px 12px;border-bottom:1px solid rgba(255,255,255,.05)}
.positions-table td{padding:12px;font-size:13px;border-bottom:1px solid rgba(255,255,255,.03)}
.positions-table tr:hover td{background:rgba(0,200,150,.02)}

.btn-sm{padding:8px 16px;border-radius:var(--radius2);font-weight:700;font-size:12px;color:#000;background:linear-gradient(135deg,var(--accent),var(--accent2));transition:.2s}
.btn-sm:hover{box-shadow:var(--glow)}
.btn-sm.danger{background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff}

/* TX result */
.tx-result{background:rgba(0,200,150,.08);border:1px solid rgba(0,200,150,.2);border-radius:var(--radius2);padding:12px 16px;margin-top:12px;font-size:13px;display:none}
.tx-result.error{background:rgba(239,68,68,.08);border-color:rgba(239,68,68,.2)}
.tx-result a{color:var(--accent);font-weight:600}

@media(max-width:640px){
  header{padding:0 12px}
  main{padding:12px}
  nav{gap:2px;padding:6px 8px}
  .nav-item{padding:8px 12px;font-size:12px}
}
</style>
</head>
<body>
<div style="position:fixed;top:0;left:0;right:0;z-index:9999;background:linear-gradient(90deg,#0f1117,#1a2332,#0f1117);padding:8px 16px;text-align:center;font-weight:800;font-size:13px;letter-spacing:1px;color:#00e87b;text-transform:uppercase;font-family:'JetBrains Mono',monospace;border-bottom:1px solid rgba(0,232,123,.3)"><span>‚ö†Ô∏è Devnet ‚Äî Mainnet Coming Soon</span></div>

<header>
  <a href="index.html" class="logo"><span>üöÄ</span><span>Send<span style="color:var(--accent)">.it</span></span></a>
  <button class="wallet-btn" id="walletBtn" onclick="connectWallet()"><i class="fas fa-wallet"></i>&nbsp; Connect Wallet</button>
</header>

<nav>
  <a href="index.html" class="nav-item"><i class="fas fa-rocket"></i> Launch</a>
  <a href="staking.html" class="nav-item"><i class="fas fa-coins"></i> Staking</a>
  <a href="trading.html" class="nav-item active"><i class="fas fa-chart-line"></i> Trading</a>
  <a href="social.html" class="nav-item"><i class="fas fa-users"></i> Social</a>
  <a href="launchpad.html" class="nav-item"><i class="fas fa-shuttle-space"></i> Launchpad</a>
  <a href="composer.html" class="nav-item"><i class="fas fa-cubes"></i> Composer</a>
</nav>

<main>

<!-- AMM Hero -->
<div style="text-align:center;padding:32px 24px 24px">
  <h1 style="font-size:40px;font-weight:900;background:linear-gradient(135deg,var(--accent),var(--accent2),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:-2px;margin-bottom:8px">AMM Trading</h1>
  <p style="color:var(--text2);font-size:15px;margin-bottom:16px">Swap, provide liquidity, and earn fees on graduated tokens</p>
  <div style="display:flex;justify-content:center;gap:24px;flex-wrap:wrap">
    <div><span class="mono" style="font-size:22px;font-weight:900;color:var(--accent)" id="stat-pools">‚Äî</span><div style="font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:1px">Pools</div></div>
    <div><span class="mono" style="font-size:22px;font-weight:900;color:var(--accent)" id="stat-tvl">‚Äî</span><div style="font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:1px">TVL (SOL)</div></div>
    <div><span class="mono" style="font-size:22px;font-weight:900;color:var(--accent)" id="stat-vol">‚Äî</span><div style="font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:1px">24h Volume</div></div>
    <div><span class="mono" style="font-size:22px;font-weight:900;color:var(--accent)">1%</span><div style="font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:1px">Swap Fee</div></div>
  </div>
</div>

<!-- Network Badge -->
<div style="text-align:center;margin-bottom:24px">
  <span class="badge badge-green" style="font-size:12px;padding:4px 12px"><i class="fas fa-circle" style="font-size:6px;vertical-align:middle"></i> Devnet</span>
  <span class="mono" style="font-size:11px;color:var(--text3);margin-left:8px">HTKq18c...88Zx</span>
</div>

<div class="trading-layout">

<!-- Left: Pool Selector -->
<div>
  <div class="card">
    <h3 class="section-title" style="font-size:16px"><i class="fas fa-water"></i> Pools</h3>
    <input type="text" placeholder="üîç Search pools..." style="margin-bottom:12px;font-size:13px" id="poolSearch">
    <div class="pool-list" id="poolList">
      <div style="text-align:center;padding:32px 12px;color:var(--text3)">
        <i class="fas fa-satellite-dish" style="font-size:28px;margin-bottom:8px;display:block;color:var(--accent)"></i>
        <div style="font-size:13px">Connect wallet to load pools</div>
      </div>
    </div>
  </div>
</div>

<!-- Center: Swap / LP -->
<div>
  <div class="card swap-card">
    <div class="tabs">
      <div class="tab active" onclick="switchTab('swap')"><i class="fas fa-exchange-alt"></i> Swap</div>
      <div class="tab" onclick="switchTab('liquidity')"><i class="fas fa-tint"></i> Liquidity</div>
    </div>

    <!-- Swap Tab -->
    <div id="swapTab">
      <div class="swap-box">
        <label>You Pay</label>
        <div class="swap-input-row">
          <input type="number" id="swapInputAmount" placeholder="0.0" oninput="calculateSwapOutput()">
          <div class="token-badge" id="swapInputToken">
            <div class="icon" style="background:linear-gradient(135deg,#9945FF,#14F195);border-radius:50%"></div>
            SOL
          </div>
        </div>
        <div class="swap-balance">Balance: <span class="mono" id="swapInputBalance">‚Äî</span> <span onclick="maxSwapInput()">MAX</span></div>
      </div>

      <div class="swap-arrow"><button onclick="flipSwap()"><i class="fas fa-arrow-down"></i></button></div>

      <div class="swap-box">
        <label>You Receive</label>
        <div class="swap-input-row">
          <input type="number" id="swapOutputAmount" placeholder="0.0" readonly>
          <div class="token-badge" id="swapOutputToken">
            <div class="icon" style="background:var(--accent);border-radius:50%"></div>
            <span id="swapOutputSymbol">TOKEN</span>
          </div>
        </div>
        <div class="swap-balance">Balance: <span class="mono" id="swapOutputBalance">‚Äî</span></div>
      </div>

      <div class="swap-details" id="swapDetails" style="display:none">
        <div class="swap-detail-row"><span class="label">Rate</span><span class="value" id="swapRate">‚Äî</span></div>
        <div class="swap-detail-row"><span class="label">Fee (1%)</span><span class="value" id="swapFee">‚Äî</span></div>
        <div class="swap-detail-row"><span class="label">LP Fee (0.3%)</span><span class="value" id="swapLpFee">‚Äî</span></div>
        <div class="swap-detail-row"><span class="label">Protocol Fee (0.7%)</span><span class="value" id="swapProtocolFee">‚Äî</span></div>
        <div class="swap-detail-row"><span class="label">Price Impact</span><span class="value" id="swapImpact">‚Äî</span></div>
        <div class="swap-detail-row"><span class="label">Min Received</span><span class="value" id="swapMinReceived">‚Äî</span></div>
      </div>

      <div class="tx-result" id="swapResult"></div>
      <button class="btn-swap" id="swapBtn" onclick="executeSwap()" disabled>Connect Wallet</button>
    </div>

    <!-- Liquidity Tab -->
    <div id="liquidityTab" style="display:none">
      <div class="lp-stats">
        <div class="lp-stat"><div class="num" id="lpPoolTokens">‚Äî</div><div class="lbl">Pool Tokens</div></div>
        <div class="lp-stat"><div class="num" id="lpPoolSol">‚Äî</div><div class="lbl">Pool SOL</div></div>
        <div class="lp-stat"><div class="num" id="lpYourShare">‚Äî</div><div class="lbl">Your Share</div></div>
        <div class="lp-stat"><div class="num" id="lpYourLp">‚Äî</div><div class="lbl">Your LP</div></div>
      </div>

      <div class="tabs" style="margin-bottom:12px">
        <div class="tab active" id="addLiqTab" onclick="switchLiqTab('add')">Add</div>
        <div class="tab" id="removeLiqTab" onclick="switchLiqTab('remove')">Remove</div>
      </div>

      <!-- Add Liquidity -->
      <div id="addLiqPanel">
        <div class="lp-form">
          <div class="lp-input-group">
            <label>SOL Amount</label>
            <input type="number" id="addLiqSol" placeholder="0.0" oninput="calculateLpTokens()">
          </div>
          <div class="lp-input-group">
            <label>Tokens Required</label>
            <input type="number" id="addLiqTokens" placeholder="‚Äî" readonly>
          </div>
        </div>
        <div style="font-size:12px;color:var(--text3);margin-bottom:12px;text-align:center">
          <i class="fas fa-info-circle"></i> You'll receive <span class="mono green" id="addLiqLpOut">‚Äî</span> LP tokens
        </div>
        <div class="tx-result" id="addLiqResult"></div>
        <button class="btn-swap" onclick="executeAddLiquidity()" id="addLiqBtn" disabled>Add Liquidity</button>
      </div>

      <!-- Remove Liquidity -->
      <div id="removeLiqPanel" style="display:none">
        <div class="lp-input-group" style="margin-bottom:12px">
          <label>LP Tokens to Burn</label>
          <input type="number" id="removeLiqAmount" placeholder="0.0" oninput="calculateRemoveOutput()">
          <div style="display:flex;gap:8px;margin-top:8px">
            <button class="btn-sm" style="font-size:11px;padding:4px 10px" onclick="setRemovePct(25)">25%</button>
            <button class="btn-sm" style="font-size:11px;padding:4px 10px" onclick="setRemovePct(50)">50%</button>
            <button class="btn-sm" style="font-size:11px;padding:4px 10px" onclick="setRemovePct(75)">75%</button>
            <button class="btn-sm" style="font-size:11px;padding:4px 10px" onclick="setRemovePct(100)">MAX</button>
          </div>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px">
          <div class="lp-input-group"><label>SOL Out</label><div class="mono" style="font-size:18px;font-weight:700;padding-top:4px" id="removeSolOut">‚Äî</div></div>
          <div class="lp-input-group"><label>Tokens Out</label><div class="mono" style="font-size:18px;font-weight:700;padding-top:4px" id="removeTokenOut">‚Äî</div></div>
        </div>
        <div class="tx-result" id="removeLiqResult"></div>
        <button class="btn-swap danger" onclick="executeRemoveLiquidity()" id="removeLiqBtn" disabled style="background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff">Remove Liquidity</button>
      </div>
    </div>
  </div>
</div>

<!-- Right: Pool Info -->
<div>
  <div class="card" style="margin-bottom:16px">
    <h3 class="section-title" style="font-size:16px"><i class="fas fa-info-circle"></i> Pool Info</h3>
    <div id="poolInfoContent" style="color:var(--text3);font-size:13px;text-align:center;padding:20px 0">
      Select a pool to view details
    </div>
  </div>

  <div class="card">
    <h3 class="section-title" style="font-size:16px"><i class="fas fa-history"></i> Recent Trades</h3>
    <div id="recentTrades" style="color:var(--text3);font-size:13px;text-align:center;padding:20px 0">
      No trades yet
    </div>
  </div>
</div>

</div>

<!-- Your LP Positions -->
<div class="card" style="margin-bottom:24px">
  <h2 class="section-title"><i class="fas fa-layer-group"></i> Your LP Positions</h2>
  <div id="lpPositions">
    <div style="text-align:center;padding:24px;color:var(--text3)">
      <i class="fas fa-water" style="font-size:28px;margin-bottom:8px;display:block;color:var(--accent)"></i>
      Connect wallet to view your LP positions
    </div>
  </div>
</div>

<!-- How it Works -->
<div class="card">
  <h2 class="section-title"><i class="fas fa-graduation-cap"></i> How Send.it AMM Works</h2>
  <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px">
    <div style="background:var(--bg);border-radius:var(--radius2);padding:16px;text-align:center">
      <div style="font-size:28px;margin-bottom:8px">üìà</div>
      <div style="font-weight:700;margin-bottom:4px">Bonding Curve</div>
      <div style="font-size:12px;color:var(--text2)">Tokens launch on a bonding curve. Price rises as supply sells.</div>
    </div>
    <div style="background:var(--bg);border-radius:var(--radius2);padding:16px;text-align:center">
      <div style="font-size:28px;margin-bottom:8px">üéì</div>
      <div style="font-weight:700;margin-bottom:4px">Graduation</div>
      <div style="font-size:12px;color:var(--text2)">When reserve hits threshold, token graduates to the AMM pool.</div>
    </div>
    <div style="background:var(--bg);border-radius:var(--radius2);padding:16px;text-align:center">
      <div style="font-size:28px;margin-bottom:8px">üèä</div>
      <div style="font-weight:700;margin-bottom:4px">x*y=k Trading</div>
      <div style="font-size:12px;color:var(--text2)">Constant product AMM. 1% fee: 0.3% to LPs, 0.7% to protocol.</div>
    </div>
    <div style="background:var(--bg);border-radius:var(--radius2);padding:16px;text-align:center">
      <div style="font-size:28px;margin-bottom:8px">üíß</div>
      <div style="font-weight:700;margin-bottom:4px">Provide Liquidity</div>
      <div style="font-size:12px;color:var(--text2)">Deposit SOL + tokens proportionally. Earn LP tokens and fees.</div>
    </div>
  </div>
</div>

</main>

<script src="trading.js"></script>
</body>
</html>
